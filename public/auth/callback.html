<!doctype html>
<html>
<body>Signing you inâ€¦</body>
<script type="module">
  import { supabase } from "/assets/supaClient.js";

  // Wait for Supabase session (Google login completes here)
  const { data } = await supabase.auth.getSession();

  const SPA_ENTRY_PATH = "/";

  const redirectToApp = () => {
    window.location.replace(SPA_ENTRY_PATH);
  };

  // If user is signed in, redirect back to the SPA entry point so routing works on GitHub Pages
  if (data?.session) {
    redirectToApp();
  }

  // Also listen in case the session appears slightly later
  supabase.auth.onAuthStateChange((_e, session) => {
    if (session) redirectToApp();
  });
</script>
</html>
