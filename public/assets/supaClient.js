// This file is generated by scripts/generate-supa-client.mjs
import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

const SUPABASE_URL = "";
const SUPABASE_ANON_KEY = "";
const DEFAULT_AUTH_CALLBACK_PATH = '/auth/callback';

export function getSupabaseRedirectUrl() {
  const configuredRedirect = null;
  if (configuredRedirect) {
    return configuredRedirect;
  }
  if (typeof window !== 'undefined' && window.location?.origin) {
    return `${window.location.origin}${DEFAULT_AUTH_CALLBACK_PATH}`;
  }
  return null;
}

if (!SUPABASE_URL || !SUPABASE_ANON_KEY) {
  throw new Error(
    'Supabase credentials are missing. Set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY before running the build.',
  );
}

export const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

if (typeof window !== 'undefined') {
  window.__LIFEGOAL_SUPABASE_REDIRECT_URL__ = getSupabaseRedirectUrl();
}
